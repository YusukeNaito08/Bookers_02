<main>
   <% if @book.errors.any? %>
   <%= @book.errors.count %> error
   <% @book.errors.full_messages.each do |message| %>
   <%= message %>
   <% end %>
  <% end %>
  
  <div class ="container mt-5">
    <div class="row">
      <div class="col-md-3">
      <table class="table">
        <h3>User info</h3>
        <%= attachment_image_tag @user,:profile_image, :fill, 60 , 60, format: 'jpeg', fallback: "no_image.jpg" %>
        <thead>
          <tr>
            <th scope="col">name</th>
            <th scope="col"><%=@user.name %></th>
          </tr>
          <tr>
            <th scope="col">introdcution</th>
            <th scope="col"><%=@user.introduction %></th>
          </tr>
        </thead>
        <tr scope="col">
         <td><%=link_to "edit", edit_user_path(@user.id) %></td>
        </tr>
      </table>

      <div class = "book_form">
        <h3>New book</h3>
        <%= form_with model: @book, local: true do |f| %>
          <h4>Title</h4>
          <%= f.text_field :title %>
          <h4>Opinion</h4>
          <%=f.text_area :body %>
          <%=f.submit 'Create Book', class: "brn btn-success" %>
        <% end %>
      </div>
     </div>

    <div class="col-md-8">
    <table class="table">
    <h3>Books</h3>
      <thead>
        <tr>
          <th scope="col"></th>
          <th scope="col">title</th>
          <th scope="col">Opinion</th>
        </tr>
      </thead>
      <tbody>
      <% @books.each do |book| %>
      <tr>
        <th scope="row"><%= attachment_image_tag book.user,:profile_image, size: "50x50", format: 'jpeg', fallback: "no_image.jpg" %></th>
        <td><%= link_to  book.title, book_path(book.id) %></td>
        <td><%= book.body %></td>

         <% if book.favorite_by?(current_user) %>
          <td><%=link_to book_favorites_path(book), method: :delete do  %>
          <i class="fas fa-heart"></br><%=book.favorites.count %></td>
          <% end %>
          <% else %>
          <td><%=link_to book_favorites_path(book), method: :post do  %>
          <i class="far fa-heart"></i></br><%=book.favorites.count%></td>
          <% end %>
          <% end %>

        <td> <i class="far fa-comment"></i></br><%=link_to  "#{book.book_comments.count}", book_path(book.id) %></td>
      </tr>
      <% end %>
      </tbody>
    </table>
  </div>
 </div>
 </div>
</main>